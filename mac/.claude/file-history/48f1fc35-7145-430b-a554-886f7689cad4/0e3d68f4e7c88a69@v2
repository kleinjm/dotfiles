# frozen_string_literal: true

Rails.application.routes.draw do
  resources :organizations, only: %i[index show] do
    resources :settings, only: %i[index update]

    resources :escrows do
      resource :passphrase, only: :show
      resources :activities, only: :index
      resource :wire_information, only: :show, controller: 'escrows/wire_informations'
      get :new_buyer, path: 'new-buyer', to: 'escrows/customers#new_buyer'
      get :new_seller, path: 'new-seller', to: 'escrows/customers#new_seller'
      resources :statement_of_infos, only: %i[new create], controller: 'escrows/statement_of_infos'

      namespace :fincen_layout do
        resource :property, only: %i[edit update]
        resources :buyers, only: %i[show new create], controller: 'customers', defaults: { customer_type: 'buyer' } do
          resource :personal_information, only: %i[edit update]
          resource :identification_document, only: %i[edit update]
          post :invite, on: :member
        end
        resources :sellers, only: %i[show new create], controller: 'customers', defaults: { customer_type: 'seller' } do
          resource :personal_information, only: %i[edit update]
          resource :identification_document, only: %i[edit update]
          post :invite, on: :member
        end
        resources :buyer_entities, only: %i[index new create], controller: 'customer_entities', defaults: { customer_type: 'buyer' } do
          member do
            resources :authorized_signatories, only: %i[new create]
            resources :beneficial_owners, only: %i[new create]
          end
        end
        resources :seller_entities, only: %i[index new create], controller: 'customer_entities', defaults: { customer_type: 'seller' } do
          member do
            resources :authorized_signatories, only: %i[new create]
            resources :beneficial_owners, only: %i[new create]
          end
        end
        resources :documents, only: :show
      end

      member do
        post :toggle_open
      end
    end

    scope module: :escrows do
      resources :customers, only: :create do
        resources :activities, only: :index
        resource :invitation, only: %i[create destroy]
        resource :identity, only: %i[show update]
        resource :funds_disbursement, only: %i[show update]
        resource :soi_tab, only: :show
      end
    end
    resources :wire_instructions, path: 'wire'
    resources :people, except: %i[show edit update] do
      get :reassign_escrows, on: :member
    end
  end
end
