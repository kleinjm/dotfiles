name: activities
root: <%= ENV["PROJECT_DIR"] %>/activities
# needed for pane-base-index 1 config
startup_pane: 1

windows:
  - editor:
      layout: main-horizontal
      panes:
        - vim -c "silent VtrAttachToPane 2"
        -
  - services:
      layout: tiled
      panes:
        - dox-dc up activities
        - (cd <%= ENV["PROJECT_DIR"] %>/dox-compose && docker-sync start -f -n activities-sync)
        - wait_for_docker activities; dox-dc up activities-workers
  - kafka:
      layout: even-horizontal
      panes:
        - wait_for_docker activities; dox-do rake consumers:run
        - wait_for_docker activities; dox-do rake events:run_listener
        - wait_for_docker activities; dox-do rake data:kafka_bridge
  - kafka-ads:
      layout: even-horizontal
      panes:
        - wait_for_docker activities; dox-do rake consumers:run_ads_priority
        - wait_for_docker activities; dox-do rake consumers:run_ads
  - consoles: wait_for_docker activities; dox-do rails c
